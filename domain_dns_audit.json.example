{
  "version": "2.7.0",
  "description": "Beispielconfig domain_dns_audit (fiktive Daten, 2 Profile)",

  "public_suffix_list": "/opt/domain_dns_audit/script/public_suffix_list.dat",

  "domains": {
    "static_domains": [
      "example.ch",
      "mail.example.ch",
      "example-ag.ch",
      "shop.example-ag.ch"
    ],
    "exclude_domains": [
      "test.example.ch"
    ]
  },

  "profiles": {
    "full": {
      "description": "Vollstaendiges Profil fuer produktive Mail Domains",

      "match": {
        "suffixes": ["*.example.ch", "*.example-ag.ch"]
      },

      "require_mx": true,
      "require_spf": true,
      "require_dkim": true,
      "require_dmarc": true,
      "require_arc": true,
      "require_dane": true,
      "require_mta_sts": true,
      "require_tls_rpt": true,
      "require_bimi": true,

      "dmarc_strict_alignment": true,
      "dmarc_ok_policies": ["reject"],

      "dkim_selectors": ["s1", "s2"],
      "arc_selectors": ["arc", "arc1"],
      "dane_ports": [25],

      "mta_sts_mode": "enforce",
      "mta_sts_max_age": 604800,

      "mx_policy": {
        "groups": [
          {
            "name": "Primary MX",
            "mx_required": [
              "mx01.mail-gw.example.ch",
              "mx02.mail-gw.example.ch"
            ],
            "mx_allow_others": false
          }
        ]
      },

      "spf_policy": {
        "groups": [
          {
            "name": "SPF Grundregeln",
            "allowed_modes": ["hard", "soft"],
            "required_contains": [
              "include:spf1.example-mail.net"
            ],
            "required_contains_any": [
              "redirect=_spf.example.ch",
              "include:spf2.example-mail.net"
            ]
          }
        ]
      },

      "dmarc_policy": {
        "allow_external_rua_domains": ["example-reporting.net"]
      },

      "dkim_policy": {
        "evaluation_mode": "all_ok",
        "expected_txt": {
          "s1": "v=DKIM1; k=rsa; p=MIIBFAKEKEYS1MIIBFAKEKEYS1MIIBFAKEKEYS1MIIBFAKEKEYS1MIIBFAKEKEYS1AB",
          "s2": "v=DKIM1; k=rsa; p=MIIBFAKEKEYS2MIIBFAKEKEYS2MIIBFAKEKEYS2MIIBFAKEKEYS2MIIBFAKEKEYS2AB"
        }
      },

      "bimi_policy": {
        "allowed_logo_domains": [
          "assets.example.ch",
          "static.example-ag.ch"
        ]
      },

      "dane_policy": {
        "min_tls_version": "1.2"
      }
    },

    "minimal": {
      "description": "Minimales Profil fuer Basis-Audit (nur MX, SPF, DKIM, DMARC)",

      "match": {
        "domains": ["example.ch", "example-ag.ch"]
      },

      "require_mx": true,
      "require_spf": true,
      "require_dkim": true,
      "require_dmarc": true,

      "require_arc": false,
      "require_dane": false,
      "require_mta_sts": false,
      "require_tls_rpt": false,
      "require_bimi": false,

      "dmarc_strict_alignment": false,
      "dmarc_ok_policies": ["quarantine", "reject"],

      "dkim_selectors": ["s1"]
    }
  },

  "dns": {
    "timeout": 10,
    "udp_timeout": 10,
    "tcp_timeout": 10,
    "retrans": 2,
    "retry": 2,
    "dnssec": 0,
    "edns_udp_size": 1232,
    "servers": ["1.1.1.1", "8.8.8.8"]
  },

  "output": {
    "log_file": "/opt/domain_dns_audit/log/domain_dns_audit.log",
    "json_file": "/opt/domain_dns_audit/script/json/domain_dns_audit.json",
    "log_level": "INFO"
  },

  "runtime": {
    "max_procs": 10
  }
}
