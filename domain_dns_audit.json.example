{
  "ldap": {
    "enabled": false,
    "ldapconfigpath": "/opt/script/domain-check/domain_dns_ldap.json"
  },

  "dns": {
    "servers": [
      "8.8.8.8",
      "1.1.1.1"
    ],
    "timeout": 5,
    "udp_timeout": 2,
    "tcp_timeout": 4
  },

  "runtime": {
    "max_procs": 20
  },

  "domains": {
    "extra_domains": [
      "example.org",
      "gw1.example.org",
      "gw2.example.org",
      "example.net",
      "gateway1.example.net",
      "example.ch"
    ],
    "exclude_domains": [
      "dummy.internal.example"
    ]
  },

  "check": {
    "require_spf": true,
    "require_dkim": true,

    "dmarc_ok_policies": [
      "reject",
      "quarantine"
    ],

    "dkim_selectors": [
      "dkimk1",
      "dkimk2"
    ],
    "dkim_txt_required_contains": [
      "v=DKIM1",
      "k=rsa"
    ],

    "mx_policy": {
      "groups": [
        {
          "name": "example_mx",
          "mx_required": [
            "mx01.example.org",
            "mx02.example.org"
          ],
          "mx_allow_others": false
        }
      ]
    },

    "spf_policy": {
      "defaults": {
        "allowed_modes": [
          "soft",
          "hard"
        ],
        "forbid_open": true
      },
      "groups": [
        {
          "name": "example_spf_group_a",
          "required_contains": [
            "redirect=_spfga.example.org"
          ]
        },
        {
          "name": "example_spf_group_b",
          "required_contains": [
            "redirect=_spfgb.example.org"
          ]
        }
      ]
    },

    "dkim_policy": {
      "evaluation_mode": "all_ok",
      "expected_txt": {
        "dkimk1": "v=DKIM1; k=rsa; p=MIIEXAMPLEKEYFOR_DKIMK1_EXAMPLE_1234567890",
        "dkimk2": "v=DKIM1; k=rsa; p=MIIEXAMPLEKEYFOR_DKIMK2_EXAMPLE_ABCDEFGHIJ"
      }
    },

    "dmarc_policy": {
      "ok_policies": [
        "reject",
        "quarantine"
      ],
      "require_rua": true,
      "allow_external_rua_domains": [
        "example.org"
      ],
      "require_external_authorization": true
    },

    "profiles": {
      "on_prem_strict": {
        "description": "On Prem Profil fuer example.org (nutzt globale MX/SPF/DMARC/DKIM Policies)"
      },

      "cloud_gateway": {
        "description": "Beispielprofil fuer ein externes Cloud Gateway",
        "require_dkim": false,
        "dmarc_ok_policies": [
          "quarantine"
        ],

        "dkim_selectors": [
          "dkimk1",
          "dkimk2"
        ],
        "dkim_txt_required_contains": [
          "v=DKIM1",
          "k=rsa"
        ],

        "dkim_policy": {
          "evaluation_mode": "any_ok",
          "expected_txt": {
            "dkimk1": "v=DKIM1;k=rsa; p=HIER_CLOUD_KEY_1_BASE64",
            "dkimk2": "v=DKIM1;k=rsa; p=HIER_CLOUD_KEY_2_BASE64"
          }
        },

        "mx_policy": {
          "groups": [
            {
              "name": "cloud_mx",
              "mx_required": [
                "inbound.gateway1.example.net"
              ],
              "mx_allow_others": true
            }
          ]
        },

        "spf_policy": {
          "defaults": {
            "allowed_modes": [
              "soft",
              "neutral"
            ],
            "forbid_open": true
          },
          "groups": [
            {
              "name": "cloud_spf",
              "required_contains": [
                "include:_spfgw.example.net"
              ]
            }
          ]
        },

        "dmarc_policy": {
          "ok_policies": [
            "quarantine"
          ],
          "require_rua": true,
          "allow_external_rua_domains": [
            "dmarc-analyzer.example"
          ],
          "require_external_authorization": true
        }
      }
    }
  },

  "output": {
    "log_file": "/var/log/script/domain_dns_audit.log",
    "json_file": "/var/log/script/domain_dns_audit.json",
    "log_level": "INFO"
  }
}
